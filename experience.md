# 经验文档

## API 集成最佳实践

### 架构设计
- 配置与业务逻辑分离，便于扩展支持更多模型
- API 配置统一接口格式 (endpoint、认证、请求/响应格式)
- 提示词模板单独管理，支持多语言
- 统一的错误处理机制

### 认证处理
- URL 参数认证 (如 Gemini)
- Header 认证 (如 DeepSeek Bearer Token)
- 封装统一的认证处理机制

### 数据处理
- 注意不同模型的请求格式差异
- 确保数据结构完整性
- 使用类型定义约束数据结构
- 响应格式统一解析
- 参数标准化 (temperature、max_tokens 等)

## 代码重构原则

### 模块化设计
- 明确模块职责边界
- 避免功能重复实现
- 合理拆分功能模块
- 保持接口一致性

### 依赖管理
- 统一的导入导出路径
- 检查所有引用点
- 确保函数单一定义
- 注意初始化顺序

### 错误处理
- UI 层负责错误展示
- 服务层继续传递错误
- 添加合适的日志
- 使用 loading 状态防止重复提交

## 项目结构规范

### 目录组织（src）
- api/: 外部 API 封装
- services/: 业务逻辑
- config/: 配置文件
- components/: UI 组件
- prompts/: 提示词模板

### 代码迁移
- 确认新实现完整性
- 检查所有依赖引用
- 完整更新所有调用点
- 保留迁移记录

## 开发环境说明

### 环境
- 当前使用windows系统，执行命令注意是windows命令，而非linux命令


### Vue 组件开发
- 事件处理函数命名匹配
- 异步操作统一处理
- 模板字符串正确使用
- 状态管理规范化
- 下拉框样式优化：
  - 使用 min-w-[width] 确保足够宽度
  - 自定义下拉箭头使用内联 SVG 作为背景图片
  - 使用 appearance-none 移除默认样式
  - 合理设置内边距确保文本显示完整

## LLM API 统一化经验

### 统一接口设计
- 使用 OpenAI 格式作为标准接口
- 将不同模型的差异封装在配置层
- 支持动态添加新模型
- 环境变量自动初始化模型状态

### 模型配置管理
- 统一的模型配置结构
  - baseUrl: API 端点
  - models: 支持的模型列表
  - defaultModel: 默认模型
  - authType: 认证类型 (bearer/query)
  - enabled: 启用状态
- 支持自定义模型配置
- API 密钥安全存储
- 动态模型启用/禁用

### 请求处理标准化
- 统一的消息格式
  - system: 系统提示词
  - user: 用户输入
- 统一的请求参数
  - temperature
  - max_tokens
- 统一的响应解析
- 错误处理标准化

### 用户界面优化
- 动态模型选择列表
- 模型配置管理界面
- 启用状态可视化
- 配置保存反馈

# 环境配置最佳实践

- `.env.local` 文件用于存储本地环境变量和敏感信息
- 应该创建 `.env.example` 作为模板文件并提交到仓库
- 环境文件应该在 `.gitignore` 中明确列出
- 常见的环境文件模式：
  - .env.local
  - .env.*.local
  - .env.development.local
  - .env.test.local
  - .env.production.local
